# Lens 2026 Platform Environment Configuration
# This file contains all environment variables used by the platform services
# Load this file before starting any service: source conf/env/lens_2026.env

# ============================================================================
# Infrastructure Services
# ============================================================================

# Nacos Configuration Center & Service Discovery
export NACOS_HOST=localhost
export NACOS_PORT=8848
export NACOS_SERVER_ADDR=${NACOS_HOST}:${NACOS_PORT}
export NACOS_NAMESPACE=lens_2026
export NACOS_GROUP=DEFAULT_GROUP

# Keycloak Identity & Access Management
export KEYCLOAK_HOST=172.28.0.1
export KEYCLOAK_PORT=28080
export KEYCLOAK_URL=http://${KEYCLOAK_HOST}:${KEYCLOAK_PORT}
export KEYCLOAK_REALM=lens
export KEYCLOAK_ADMIN_USERNAME=admin
export KEYCLOAK_ADMIN_PASSWORD=admin
export KEYCLOAK_CLIENT_ID=lens-client
export KEYCLOAK_CLIENT_SECRET=x6lEH0DMcT27eop2cszIP3Brc2sDQHLb

# Database (MariaDB)
export DB_HOST=localhost
export DB_PORT=33306
export DB_NAME=lens_2026
export DB_USERNAME=lens
export DB_PASSWORD=lens
export DB_URL=jdbc:mariadb://${DB_HOST}:${DB_PORT}/${DB_NAME}

# Redis Cache
export REDIS_HOST=localhost
export REDIS_PORT=6379
export REDIS_PASSWORD=
export REDIS_DATABASE=0

# RabbitMQ Message Queue
export RABBITMQ_HOST=localhost
export RABBITMQ_PORT=5672
export RABBITMQ_USERNAME=guest
export RABBITMQ_PASSWORD=guest
export RABBITMQ_VIRTUAL_HOST=/

# ============================================================================
# Platform Services Ports
# ============================================================================

# Gateway Service
export GATEWAY_PORT=8050
export GATEWAY_HOST=localhost
export GATEWAY_URL=http://${GATEWAY_HOST}:${GATEWAY_PORT}

# Auth Service
export AUTH_PORT=8041
export AUTH_HOST=localhost
# AUTH_URL should use gateway URL for Swagger UI to avoid CORS
export AUTH_URL=http://${GATEWAY_HOST}:${GATEWAY_PORT}/v2/lens/platform/auth

# System Service
export SYSTEM_PORT=8042
export SYSTEM_HOST=localhost
# SYSTEM_URL should use gateway URL for Swagger UI to avoid CORS
export SYSTEM_URL=http://${GATEWAY_HOST}:${GATEWAY_PORT}/v2/lens/platform/system

# Monitor Service
export MONITOR_PORT=8043
export MONITOR_HOST=localhost
export MONITOR_URL=http://${MONITOR_HOST}:${MONITOR_PORT}

# ============================================================================
# Security Configuration
# ============================================================================

# JWT Configuration
export JWT_JWK_SET_URI=${KEYCLOAK_URL}/realms/${KEYCLOAK_REALM}/protocol/openid-connect/certs
export JWT_ISSUER_URI=${KEYCLOAK_URL}/realms/${KEYCLOAK_REALM}

# ============================================================================
# Logging Configuration
# ============================================================================

# Log Levels
export LOG_LEVEL_ROOT=INFO
export LOG_LEVEL_LENS=DEBUG
export LOG_LEVEL_SPRING_SECURITY=DEBUG
export LOG_LEVEL_SPRING_GATEWAY=DEBUG

# ============================================================================
# OpenAPI / Swagger Configuration
# ============================================================================

export OPENAPI_VERSION=2.0.0

# ============================================================================
# Monitoring & Metrics
# ============================================================================

# Prometheus
export PROMETHEUS_HOST=localhost
export PROMETHEUS_PORT=9090
export PROMETHEUS_URL=http://${PROMETHEUS_HOST}:${PROMETHEUS_PORT}

# Zipkin (Distributed Tracing)
export ZIPKIN_HOST=localhost
export ZIPKIN_PORT=9411
export ZIPKIN_URL=http://${ZIPKIN_HOST}:${ZIPKIN_PORT}

# ============================================================================
# Spring Boot Admin
# ============================================================================

export SPRING_BOOT_ADMIN_CONTEXT_PATH=/admin

# ============================================================================
# Application Profile
# ============================================================================

export SPRING_PROFILES_ACTIVE=dev

# ============================================================================
# Display Configuration (Optional - for verification)
# ============================================================================

if [ "$1" = "--show" ]; then
  echo "=========================================="
  echo "Lens 2026 Environment Configuration"
  echo "=========================================="
  echo ""
  echo "Infrastructure:"
  echo "  Nacos:     ${NACOS_SERVER_ADDR} (namespace: ${NACOS_NAMESPACE})"
  echo "  Keycloak:  ${KEYCLOAK_URL} (realm: ${KEYCLOAK_REALM})"
  echo "  Database:  ${DB_HOST}:${DB_PORT}/${DB_NAME}"
  echo "  Redis:     ${REDIS_HOST}:${REDIS_PORT}"
  echo "  RabbitMQ:  ${RABBITMQ_HOST}:${RABBITMQ_PORT}"
  echo ""
  echo "Platform Services:"
  echo "  Gateway:   ${GATEWAY_URL}"
  echo "  Auth:      ${AUTH_URL}"
  echo "  System:    ${SYSTEM_URL}"
  echo "  Monitor:   ${MONITOR_URL}"
  echo ""
  echo "Security:"
  echo "  JWT JWK:   ${JWT_JWK_SET_URI}"
  echo ""
  echo "Monitoring:"
  echo "  Prometheus: ${PROMETHEUS_URL}"
  echo "  Zipkin:     ${ZIPKIN_URL}"
  echo ""
  echo "=========================================="
fi
